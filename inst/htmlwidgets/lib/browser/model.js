// Generated by CoffeeScript 1.12.7-patch.2
(function() {
  var DataSet;

  DataSet = function(raw) {
    var dataset, stratified;
    dataset = function() {};
    stratified = function() {
      var stratify;
      stratify = d3.stratify().id(function(d) {
        return d.id;
      }).parentId(function(d) {
        if (d.parents instanceof Array) {
          return d.parents[0];
        }
        return d.parents;
      });
      return stratify(raw);
    };
    dataset.traverseAsTree = function(fun, root) {
      var strats, traverse;
      log.debug("traversing as tree");
      traverse = function(fun, node, parent) {
        var child, i, len, ref, results;
        fun(node.data, parent);
        if (node.children) {
          ref = node.children;
          results = [];
          for (i = 0, len = ref.length; i < len; i++) {
            child = ref[i];
            results.push(traverse(fun, child, node.data));
          }
          return results;
        }
      };
      strats = stratified();
      return traverse(fun, strats, root);
    };
    return dataset;
  };

  window.DataSet = DataSet;

}).call(this);
